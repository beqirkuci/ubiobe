<div class="row">
  <ng-template #content let-c="close" let-d="dismiss">
    <form action="" class="form-horizontal form-material" (submit)="createPost();" ngNativeValidate>
      <div class="modal-header">
        <h4 class="modal-title">Aggiungi post</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">

        <div class="form-group">
          <label class="col-md-12">Titolo</label>
          <div class="col-md-12">
            <input type="text" placeholder="Titolo" class="form-control form-control-line" name="caption" [(ngModel)]="postObject.caption"
              required oninvalid="this.setCustomValidity('Titolo non può essere vuoto.')" onchange="this.setCustomValidity('')">
          </div>
        </div>

        <div class="form-group">
          <label class="col-md-12">Testo</label>
          <div class="col-md-12">
            <textarea type="text" rows="5" placeholder="Testo" class="form-control form-control-line" name="text"
              [(ngModel)]="postObject.text" required oninvalid="this.setCustomValidity('Text non può essere vuoto.')"
              onchange="this.setCustomValidity('')"></textarea>
          </div>
        </div>

        <div class="form-group">
          <label for="filePost"></label>
          <input type="file" id="filePost" accept="image/x-png,image/gif,image/jpeg" (change)="handleFileInputforPost($event.target.files)">
          <span *ngIf="imageSrc !== ''">
            <img id="image" [src]="imageSrc || ''" style="width: 120px;" />
          </span>
        </div>


      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-secondary">Crea</button>
        <button type="button" class="btn btn-secondary" id="closeCreatePostModal" (click)="c('Close click')">Cancella</button>
      </div>
    </form>
  </ng-template>

  <!-- Column -->
  <div class="col-lg-4 col-xlg-3 col-md-5">
    <div class="card">
      <div class="card-body">
        <div class="m-t-30 text-center">
          <div>
            <img src="{{userDetails.profilePic}}" class="rounded-circle" width="150" height="150" [class.user]="userDetails.permission == 'user'"
              [class.ambassador]="userDetails.permission == 'ambassador'" [class.professional]="userDetails.permission == 'professional'" />
          </div>
          <button *ngIf="!userDetails.contact" class="btn btn-rounded btn-outline-dark" style="margin-top: 10px;"
            (click)="uploadProfilePic(uploadProfilePicture)"><i class="fas fa-camera-retro"></i> Cambia immagine del
            profilo</button>

          <ng-template #uploadProfilePicture let-c="close" let-d="dismiss" style="margin-top: 150px;">
            <div class="modal-header">
              <h4 class="modal-title">Carica l'immagine del profilo</h4>
              <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label for="filePost"></label>
                <input type="file" id="filePost" accept="image/x-png,image/gif,image/jpeg" (change)="handleFileInputforProfilePic($event.target.files)">
                <span *ngIf="imageSrc !== ''">
                  <img id="image" [src]="imageSrc || ''" style="width: 120px;" />
                </span>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" id="closeProfilePic" (click)="c('Close click')">Cancella</button>
              <button type="button" class="btn btn-warning" (click)="uploadProfilePict()" [disabled]="!profilePicToUpload"><span
                  class="fa fa-upload"></span> Upload</button>
            </div>
          </ng-template>

          <h4 class="card-title m-t-10">{{userDetails.name}} {{userDetails.surname}}</h4>
          <h6 class="card-subtitle">{{userDetails.profession}}</h6>
          <div class="m-t-30 row text-center justify-content-md-center">
            <div class="col-4">
              <a href="javascript:void(0)" class="link">
                <i class="icon-people m-r-10" style="margin-right: 0;"></i>
                {{totalUsers}}
              </a>
            </div>
            <span class="col-8" *ngIf="loggedInUserRole !== 'professional'">
              <div *ngIf="userDetails.contact && !userDetails.sharedMyData">
                <a href="javascript:void(0)" class="link" (click)="shareData()">
                  <i class="far fa-share-square m-r-10" style="margin-right: 0;">
                  </i>
                  Condividi i miei dati riservati
                </a>
              </div>
              <div *ngIf="userDetails.contact && userDetails.sharedMyData">
                <a href="javascript:void(0)" class="link">
                  <i class="fas fa-check m-r-10" style="margin-right: 0;">
                  </i>
                  Ho condiviso i miei dati personali
                </a>
              </div>
            </span>
          </div>
        </div>
      </div>
      <div>
        <hr>
      </div>
      <div class="card-body">
        <div class="row" *ngIf="!userDetails.nickname && !userDetails.contact">
          <div class="form-group col-md-8">
            <!-- <label class="col-md-12">Set nickname</label> -->
            <div class="col-md-12">
              <input type="text" placeholder="Imposta nickname" class="form-control form-control-line" name="nickname"
                [(ngModel)]="nickname">
            </div>
          </div>
          <div class="form-group col-md-4">
            <div class="col-sm-12">
              <button class="btn btn-success" type="text" (click)="updateProfile(nickname)">Aggiungi</button>
            </div>
          </div>
        </div>
        <div *ngIf="userDetails.nickname && !userDetails.contact">
          <small class="text-muted">Nickname</small>
          <h6>{{userDetails.nickname}}</h6>
        </div>
        <div *ngIf="!userDetails.isEmailPrivate || !userDetails.contact">
          <small class="text-muted">Email</small>
          <h6>{{userDetails.email}}</h6>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-8 col-xlg-9 col-md-7">
    <div class="card">
      <ngb-tabset type="pills" class="custom-pills">
        <ngb-tab title="Attività" id="activity">
          <ng-template ngbTabContent>
            <div class="card-body">
              <div class="col-md-12" *ngIf="!userDetails.contact"><textarea class="form-control form-control-line"
                  placeholder="Clicca per aggiungere un post.." rows="3" style="cursor:pointer;" (click)="openPostModal(content)"></textarea></div>
              <div class="profiletimeline" *ngIf="postsArrays.length !== 0">
                <div class="sl-item">
                  <div class="sl-right" *ngFor="let postsArray of postsArrays; let i = index">
                    <div>
                      <div class="sl-left">
                        <img src={{userDetails.profilePic}} class="rounded-circle" width="40" height="40" />
                      </div>
                      <a href="#" class="link" style="text-transform: capitalize !important;">{{postsArray.name}}</a>
                      <span class="sl-date" style="margin-left: 10px;text-transform: capitalize !important;">{{postsArray.time}}</span>
                      <span *ngIf="!userDetails.contact && editPostId!==postsArray._id" style="float: right;margin-left: 10px;"
                        class="fa fa-times" (click)="confirmDeletePost(DeletePost)"></span>
                      <span *ngIf="!userDetails.contact && editPostId!==postsArray._id" style="float: right;" class="fa fa-edit"
                        (click)="changePostStatus(postsArray._id)"></span>

                      <ng-template #DeletePost let-c="close" let-d="dismiss" style="margin-top: 150px;">
                        <div class="modal-header">
                          <h4 class="modal-title">Elimina post</h4>
                          <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <p>Sei sicuro di voler eliminare questo post ?</p>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" id="close" (click)="c('Close click')">Cancella</button>
                          <button type="button" class="btn btn-danger" (click)="deletePost(postsArray._id)">Elimina</button>
                        </div>
                      </ng-template>
                      <div>
                        <div *ngIf="editPostId!==postsArray._id" class="paragraphHover" style="margin-top: 10px;">
                          <h4>{{postsArray.caption}}</h4>
                          <p>{{postsArray.text}}</p>
                        </div>
                        <div *ngIf="postEditable && editPostId===postsArray._id">
                          <form action="" class="form-horizontal m-t-20 row" (submit)="editPost(postsArray._id, postsArray.caption, postsArray.text);"
                            ngNativeValidate>
                            <input type="text" placeholder="Titolo" class="form-control form-control-line" name="caption"
                              [(ngModel)]="postsArray.caption" required oninvalid="this.setCustomValidity('Titolo non può essere vuoto.')"
                              onchange="this.setCustomValidity('')">
                            <textarea class="form-control form-control-line m-t-20" placeholder="Text ..." rows="3"
                              name="text" [(ngModel)]="postsArray.text" required oninvalid="this.setCustomValidity('Text non può essere vuoto.')"
                              onchange="this.setCustomValidity('')"></textarea>
                            <button type="button" class="btn btn-outline-dark m-t-20" (click)="changePostStatus('')">Cancella</button>
                            <button type="submit" class="btn btn-outline-warning m-t-20">Aggiorna</button>
                          </form>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-lg-8 col-md-6 m-b-20">
                          <img src="{{postsArray.img}}" class="img-fluid radius" />
                        </div>
                      </div>
                      <div class="like-comm">
                        <a href="javascript:void(0)" class="link m-r-10" (click)="like(postsArray._id)">
                          <img src="assets/images/logo-icon.png" width="20" /></a>

                        <ng-template #likes>
                          <div *ngFor="let user of postsArray.likes; let i = index">
                            <p style="color: #fff !important;">{{user.name}} {{user.surname}}</p>
                          </div>
                          <div *ngIf="postsArray.likes.length===0">No likes</div>
                        </ng-template>

                        <ng-template #LikesModal let-c="close" let-d="dismiss" style="margin-top: 150px;">
                          <div class="modal-header">
                            <h4 class="modal-title">Likes</h4>
                            <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                              <span aria-hidden="true">&times;</span>
                            </button>
                          </div>
                          <div class="modal-body">
                            <div *ngFor="let user of postsArray.likes; let i = index">
                              <p>{{user.name}} {{user.surname}}</p>
                            </div>
                            <div *ngIf="postsArray.likes.length===0">No likes</div>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" id="closeLikesModal" (click)="c('Close click')">Chiudi</button>
                          </div>
                        </ng-template>

                        <span id="{{postsArray._id}}" class="pointer" placement="top" [ngbTooltip]="likes" (click)="openLikesModal(LikesModal)">{{postsArray.totalLikes}}
                          <span *ngIf="postsArray.totalLikes===1"> Like</span>
                          <span *ngIf="postsArray.totalLikes!==1"> Likes</span>
                        </span>
                      </div>

                      <div class="row">
                        <div class="col-11">
                          <div class="input-field m-t-30">
                            <textarea id="comment{{i}}" name="comment{{i}}" rows="3" placeholder="Leave a comment"
                              class="form-control form-control-line" type="text" [(ngModel)]="comment"></textarea>
                          </div>
                        </div>
                        <div class="col-1 m-t-30">
                          <a class="btn-circle btn-lg btn-cyan float-right text-white" href="javascript:void(0)"
                            (click)="addComment(postsArray._id)">
                            <i class="fas fa-paper-plane"></i>
                          </a>
                        </div>
                      </div>

                      <div class="row" *ngFor="let comment of postsArray.comments; let i = index">
                        <div class="">
                          <div class="card-body">
                            <h4 class="card-title">{{comment.name}} {{comment.surname}}</h4>
                            <h6 class="card-subtitle mb-2 text-muted capitalize">{{comment.createdAt}}</h6>
                            <p class="card-text">{{comment.comment}}</p>
                          </div>
                        </div>
                      </div>

                    </div>
                    <hr>
                  </div>
                </div>
              </div>
              <div class="profiletimeline" *ngIf="postsArrays.length === 0">
                <h4>Non ci sono posts</h4>
              </div>
            </div>
          </ng-template>
        </ngb-tab>
        <ngb-tab>
          <ng-template ngbTabTitle>
            <div (click)="profileData('active')">Profilo</div>
          </ng-template>
          <ng-template ngbTabContent>
            <div class="card-body">
              <h4 class="font-medium m-t-30">Informazioni di base</h4>
              <hr>
              <div class="card">
                <div class="card-body">
                  <p class="card-text">
                    <div>
                      <strong>Nome</strong>
                      <br>
                      <p class="text-muted">{{userDetails.name}}</p>
                    </div>
                    <div>
                      <strong>Cognome</strong>
                      <br>
                      <p class="text-muted">{{userDetails.surname}}</p>
                    </div>
                    <div>
                      <strong>Nickname</strong>
                      <br>
                      <p *ngIf="userDetails.nickname" class="text-muted">{{userDetails.nickname}}</p>
                      <p *ngIf="!userDetails.nickname" class="text-muted">Nickname non impostato</p>
                    </div>
                    <div>
                      <strong>Genere</strong>
                      <br>
                      <p class="text-muted">{{userDetails.gender}}</p>
                    </div>
                    <div>
                      <strong>Data di nascita</strong>
                      <br>
                      <p class="text-muted" style="text-transform: capitalize;">{{userDetails.dateOfBirthFormatted}}</p>
                    </div>
                    <div>
                      <strong>Luogo di nascita</strong>
                      <br>
                      <p *ngIf="userDetails.placeOfBirth" class="text-muted">{{userDetails.placeOfBirth}}</p>
                      <p *ngIf="!userDetails.placeOfBirth" class="text-muted">Luogo di nascita non impostato</p>
                    </div>
                    <div>
                      <strong>Indirizzo</strong>
                      <br>
                      <p *ngIf="userDetails.address" class="text-muted">{{userDetails.address}}</p>
                      <p *ngIf="!userDetails.address" class="text-muted">Indirizzo non impostato</p>
                    </div>
                    <div>
                      <strong>Stato civile</strong>
                      <br>
                      <p *ngIf="userDetails.maritalStatus" class="text-muted">{{userDetails.maritalStatus}}</p>
                      <p *ngIf="!userDetails.maritalStatus" class="text-muted">Stato civile non impostato</p>
                    </div>
                </div>
              </div>
              <div id="privateData">
                <h4 class="font-medium m-t-30">Informazioni di contatto</h4>
                <hr>
                <div class="card">
                  <div class="card-body">
                    <p class="card-text">
                      <div>
                        <strong>Professione</strong>
                        <br>
                        <p *ngIf="userDetails.profession" class="text-muted">{{userDetails.profession}}</p>
                        <p *ngIf="!userDetails.profession" class="text-muted">Professione non impostato</p>
                      </div>
                      <div *ngIf="!userDetails.isEmailPrivate || !userDetails.contact">
                        <div>
                          <strong>Email</strong>
                          <br>
                          <p class="text-muted">{{userDetails.email}}</p>
                        </div>
                        <div>
                          <strong>Seconda email</strong>
                          <br>
                          <p *ngIf="userDetails.email2" class="text-muted">{{userDetails.email2}}</p>
                          <p *ngIf="!userDetails.email2" class="text-muted">Seconda email non impostato</p>
                        </div>
                      </div>
                      <div>
                        <strong>Tel. Cellulare</strong>
                        <br>
                        <p *ngIf="userDetails.telMobile" class="text-muted">{{userDetails.telMobile}}</p>
                        <p *ngIf="!userDetails.telMobile" class="text-muted">Tel. Cellulare non impostato</p>
                      </div>
                      <div>
                        <strong>Tel. ufficio</strong>
                        <br>
                        <p *ngIf="userDetails.telOffice" class="text-muted">{{userDetails.telOffice}}</p>
                        <p *ngIf="!userDetails.telOffice" class="text-muted">Tel. ufficio non impostato</p>
                      </div>
                  </div>
                </div>
              </div>
              <div id="privateData" *ngIf="userDetails.permission !== 'professional'">
                <h4 class="font-medium m-t-30">Dati riservati</h4>
                <hr>
                <div class="card" *ngIf="!userDetails.private || !userDetails.contact">
                  <div class="card-body">
                    <p class="card-text">
                      <div>
                        <strong>Altezza</strong>
                        <br>
                        <p *ngIf="userDetails.height" class="text-muted">{{userDetails.height}} cm</p>
                        <p *ngIf="!userDetails.height" class="text-muted">Altezza non impostato</p>
                      </div>
                      <div>
                        <strong>Peso</strong>
                        <br>
                        <p *ngIf="userDetails.weight" class="text-muted">{{userDetails.weight}} kg</p>
                        <p *ngIf="!userDetails.weight" class="text-muted">Peso non impostato</p>
                      </div>
                      <div>
                        <strong>BMI</strong>
                        <br>
                        <p *ngIf="userDetails.bmi" class="text-muted">{{userDetails.bmi}}</p>
                        <p *ngIf="!userDetails.bmi" class="text-muted">BMI non impostato</p>
                      </div>
                      <div>
                        <strong>BMI Descrizione</strong>
                        <br>
                        <p *ngIf="userDetails.bmiDescription" class="text-muted">{{userDetails.bmiDescription}}</p>
                        <p *ngIf="!userDetails.bmiDescription" class="text-muted">BMI descrizione non impostato</p>
                      </div>
                  </div>
                </div>
                <div class="card" *ngIf="userDetails.private && userDetails.contact">
                  <div class="card-body">
                    <p class="card-text">
                      <div>
                        <strong>OOPS!</strong>
                        <br>
                        <p class="text-muted">Questi dati sono privati. Richiesta di vedere.</p>
                      </div>
                  </div>
                </div>
              </div>
              <div id="proData" *ngIf="userDetails.permission === 'professional'">
                <h4 class="font-medium m-t-30">Dati professionali</h4>
                <hr>
                <p class="card-text">
                  <div class="m-t-30" *ngFor="let experience of userDetails.experiences; let i = index;">
                    <strong>{{experience.title}}</strong>
                    <br>
                    <p *ngIf="!experience.workHere" class="capitalize">{{experience.fromFormatted}} -
                      {{experience.toFormatted}}</p>
                    <p *ngIf="experience.workHere" class="capitalize">{{experience.fromFormatted}} - Present</p>
                    <p>{{experience.experience}}</p>
                    <button type="button" class="btn btn-warning" (click)="viewDocument(experience.path)">Vedi
                      documento</button>
                  </div>
                  <div class="card" *ngIf="userDetails.experiences.length === 0">
                    <div class="card-body">
                      <p class="card-text">
                        <div>
                          <p>Non ci sono dati professionali</p>
                        </div>
                    </div>
                  </div>
              </div>
            </div>
          </ng-template>
        </ngb-tab>
        <ngb-tab title="Gestisci profilo" *ngIf="!userDetails.contact">
          <ng-template ngbTabContent>
            <div class="card-body">
              <h4 class="font-medium m-t-30">Informazioni di base</h4>
              <hr>
              <form class="form-horizontal form-material m-t-30" (submit)="updateProfile()" ngNativeValidate>
                <div class="form-group">
                  <label class="col-md-12">Nome</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="Nome" class="form-control form-control-line" name="name"
                      [(ngModel)]="userDetails.name">
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-12">Cognome</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="Cognome" class="form-control form-control-line" name="surname"
                      [(ngModel)]="userDetails.surname">
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-12">Nickname</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="Nickname" class="form-control form-control-line" name="nickname"
                      [(ngModel)]="userDetails.nickname">
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-12">Genere</label>
                  <div class="col-sm-12">
                    <select class="form-control form-control-line" name="gender" [(ngModel)]="userDetails.gender">
                      <option value="Female">Femminile</option>
                      <option value="Male">Maschile</option>
                      <option value="Not Declared">Non dichiarato</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-12">Data di nascita</label>
                  <div class="col-md-12">
                    <input type="date" placeholder="Data di nascita" id="userDetails.dateOfBirth" class="form-control form-control-line"
                      name="userDetails.dateOfBirth" [ngModel]="userDetails.dateOfBirth | date:'yyyy-MM-dd'"
                      (ngModelChange)="userDetails.dateOfBirth = $event" [value]="userDetails.dateOfBirth | date:'yyyy-MM-dd'">
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-12">Luogo di nascita</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="Luogo di nascita" class="form-control form-control-line" name="placeOfBirth"
                      [(ngModel)]="userDetails.placeOfBirth">
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-12">Indirizzo</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="Indirizzo" class="form-control form-control-line" name="address"
                      [(ngModel)]="userDetails.address">
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-12">Stato civile</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="Stato civile" class="form-control form-control-line" name="maritalStatus"
                      [(ngModel)]="userDetails.maritalStatus">
                  </div>
                </div>
                <h4 class="font-medium m-t-30">Informazioni di contatto</h4>
                <hr>
                <div class="form-group">
                  <label for="example-email" class="col-md-12">Professione</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="Professione" class="form-control form-control-line" name="profession"
                      [(ngModel)]="userDetails.profession">
                  </div>
                </div>

                <div class="form-group">
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="privateEmail" name="privateEmail"
                      [(ngModel)]="userDetails.isEmailPrivate">
                    <label for="privateEmail" class="custom-control-label">Email Privato?</label>
                  </div>
                </div>

                <div class="form-group">
                  <label for="email" class="col-md-12">Email</label>
                  <div class="col-md-12">
                    <input type="email" placeholder="Email" class="form-control form-control-line" name="email"
                      [(ngModel)]="userDetails.email" required="" id="example-email">
                  </div>
                </div>

                <div class="form-group">
                  <label for="email2" class="col-md-12">Seconda email</label>
                  <div class="col-md-12">
                    <input type="email" placeholder="Seconda email" class="form-control form-control-line" name="email2"
                      [(ngModel)]="userDetails.email2" id="example-email">
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-12">Tel. Cellulare</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="123 456 7890" class="form-control form-control-line" name="telMobile"
                      [(ngModel)]="userDetails.telMobile">
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-12">Tel. ufficio</label>
                  <div class="col-md-12">
                    <input type="text" placeholder="123 456 7890" class="form-control form-control-line" name="telOffice"
                      [(ngModel)]="userDetails.telOffice">
                  </div>
                </div>
                <div *ngIf="userDetails.permission !== 'professional'">
                  <h4 class="font-medium m-t-30">Dati riservati</h4>
                  <hr>
                  <div class="form-group">
                    <label class="col-md-12">Altezza (cm)</label>
                    <div class="col-md-12">
                      <input type="text" placeholder="Altezza (cm)" class="form-control form-control-line" name="height"
                        [(ngModel)]="userDetails.height">
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-12">Peso (Kg)</label>
                    <div class="col-md-12">
                      <input type="text" placeholder="Peso (kg)" class="form-control form-control-line" name="weight"
                        [(ngModel)]="userDetails.weight">
                    </div>
                  </div>
                </div>
                <div *ngIf="userDetails.permission === 'professional'">
                  <h4 class="font-medium m-t-30">Dati professionali</h4>
                  <hr>
                  <div *ngFor="let experience of userDetails.experiences; let i = index;">
                    <div class="form-group">
                      <label class="col-md-12">Esperienza {{i+1}}</label>
                      <div class="col-md-12 form-group">
                        <input type="text" placeholder="Titolo" class="form-control form-control-line" name="experience.title{{i}}"
                          [(ngModel)]="experience.title">
                      </div>
                      <div class="row form-group">
                        <div class="col-md-6" style="max-width: 49%;float:left;margin-left: 4px;width: 100%;">
                          <input type="date" placeholder="from" id="experience.from{{i}}" class="form-control form-control-line"
                            name="experience.from{{i}}" [ngModel]="experience.from | date:'yyyy-MM-dd'" (ngModelChange)="experience.from = $event"
                            [value]="experience.from | date:'yyyy-MM-dd'">
                        </div>
                        <div *ngIf="experience.to" class="col-md-6" style="max-width: 49%;float:left;margin-left: 4px;width: 100%;">
                          <input type="date" placeholder="to" id="experience.to{{i}}" class="form-control form-control-line"
                            name="experience.to{{i}}" [ngModel]="experience.to | date:'yyyy-MM-dd'" (ngModelChange)="experience.to = $event"
                            [value]="experience.to | date:'yyyy-MM-dd'">
                        </div>
                        <div *ngIf="!experience.to" class="col-md-2">
                          <p>Present</p>
                        </div>
                      </div>
                      <div class="col-md-12">
                        <textarea rows="5" class="form-control form-control-line" name="experience{{i}}" [(ngModel)]="experience.experience"
                          required oninvalid="this.setCustomValidity('Esperienza non può essere vuoto')" oninput="setCustomValidity('')"></textarea>
                      </div>
                    </div>
                  </div>
                </div>

                <ng-template #confirmPro let-c="close" let-d="dismiss" style="margin-top: 100px;">
                  <div class="modal-header">
                    <h4 class="modal-title">Si prega di completare in seguito ...</h4>
                    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <p>Per registrarti come professionista, devi confermare e poi procedi.</p>
                    <div class="custom-control custom-checkbox">
                      <input type="checkbox" class="custom-control-input" id="condition" name="condition" [(ngModel)]="condition">
                      <label class="custom-control-label" for="condition">Hai esperienza come professionista?</label>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-success" (click)="save(proSignupForm);">Continua</button>
                    <button type="button" id="btnClose" class="btn btn-secondary" (click)="c('Close click')">Cancella</button>
                  </div>
                </ng-template>

                <ng-template #proSignupForm let-c="close" let-d="dismiss" style="margin-top: 100px;">
                  <div class="modal-header">
                    <h4 class="modal-title">Esperienze</h4>
                    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="col-md-12" id="proSignup">
                      <div class="card" style="align-items: center; padding: 10px;">
                        <img class="card-img-top img-responsive" src="assets/images/logo-icon.png" alt="logo" style="width: 60px;">
                        <div class="card-body">
                          <div class="d-flex no-block align-items-center m-b-15">
                          </div>
                          <h3 class="font-normal" style="text-align: center;"></h3>
                          <br>
                          <div>
                            <!-- experiences form -->
                            <form (ngSubmit)="processForm()" [formGroup]="form" ngNativeValidate>
                              <div class="form-group" formArrayName="experiences">
                                <div *ngFor="let experience of form.controls.experiences.controls; let i = index;">

                                  <div class="panel panel-primary">
                                    <div class="panel-heading row">
                                      <div class="form-group col-md-8">
                                        <h4><label style="margin-left: 4px;">Esperienza #{{ i + 1 }}</label></h4>
                                      </div>
                                      <div class="form-group text-right col-md-4" *ngIf="form.controls.experiences.controls.length > 1"
                                        (click)="removeExperience(i)">
                                        <button type="text" class="btn btn-danger"><span class="fas fa-minus-circle"></span>
                                          Rimuovi</button>
                                      </div>
                                    </div>

                                    <div class="panel-body" [formGroupName]="i">

                                      <div class="form-group">
                                        <label class="col-md-12">Titolo</label>
                                        <div class="col-md-12">
                                          <input type="text" placeholder="Titolo" class="form-control form-control-line"
                                            formControlName="title" required oninvalid="this.setCustomValidity('Titolo non può essere vuoto')"
                                            oninput="setCustomValidity('')">
                                        </div>
                                      </div>

                                      <div class="form-group" style="max-width: 50%;float:left;">
                                        <label class="col-md-12">Da</label>
                                        <div class="col-md-12">
                                          <input type="date" placeholder="From" class="form-control form-control-line"
                                            formControlName="from" required oninvalid="this.setCustomValidity('Da non può essere vuoto')"
                                            oninput="setCustomValidity('')">
                                        </div>
                                      </div>

                                      <div class="form-group" style="max-width: 50%;float:left;">
                                        <div *ngIf="form.controls.experiences.controls.length-1 !== i || workHere">
                                          <label class="col-md-12">Al</label>
                                          <div class="col-md-12">
                                            <input type="date" placeholder="To" class="form-control form-control-line"
                                              formControlName="to" required oninvalid="this.setCustomValidity('Al non può essere vuoto')"
                                              oninput="setCustomValidity('')">
                                          </div>
                                        </div>
                                        <div class="col-md-12" *ngIf="form.controls.experiences.controls.length-1 === i"
                                          [class.workHere]="!workHere">
                                          <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input" id="workHere"
                                              formControlName="workHere" (change)="workHereChange($event)">
                                            <label class="custom-control-label" for="workHere">Lavoro ancora qui.</label>
                                          </div>
                                        </div>

                                        <span class="help-block" *ngIf="formErrors.experiences[i].to">
                                          {{ formErrors.experiences[i].to }}
                                        </span>
                                      </div>

                                      <div class="form-group">
                                        <label class="col-md-12">Esperienza</label>
                                        <div class="col-md-12">
                                          <textarea rows="5" class="form-control form-control-line" formControlName="experience"
                                            required oninvalid="this.setCustomValidity('Esperienza non può essere vuoto')"
                                            oninput="setCustomValidity('')"></textarea>
                                        </div>
                                      </div>

                                      <div class="form-group">
                                        <div class="row" style="width: 90% !important;margin-left: 0px !important; margin-right: 10px !important; ">
                                          <div class="custom-file col-md-10">
                                            <input type="file" id="file" (change)="handleFileInput($event.target.files, i)">
                                            <!-- <label for="file">Choose file</label> -->
                                          </div>
                                          <div class="input-group-append col-md-2">
                                            <div *ngIf="!form.controls.experiences.controls[i]['value'].path">
                                              <button class="btn btn-raised btn-success" type="button" (click)="uploadFileToActivity(i)"
                                                [disabled]="!form.controls.experiences.controls[i]['value'].fileToUpload"><span
                                                  class="fa fa-upload"></span> Upload</button></div>
                                            <div *ngIf="form.controls.experiences.controls[i]['value'].path">
                                              <button class="btn btn-raised btn-success" type="button" (click)="uploadFileToActivity(i)"
                                                [disabled]="form.controls.experiences.controls[i]['value'].path"><span
                                                  class="fas fa-check"></span> Done</button> </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <!-- add Experience button -->
                              <div class="text-left m-b-20" style="margin-left: 10px;">
                                <a (click)="addExperience()" class="btn btn-info"><span class="fas fa-plus-circle"></span>
                                  Aggiungi esperienza</a>
                              </div>

                              <div class="modal-footer">
                                <button type="submit" class="btn btn-success">Continua</button>
                                <button type="button" id="btnClose" class="btn btn-secondary" (click)="c('Close click')">Cancella</button>
                              </div>

                            </form>

                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>

                <div *ngIf="userDetails.permission!=='professional'" class="form-group">
                  <div class="col-md-12">
                    <button type="button" class="btn btn-block btn-outline-secondary" style="width: auto;" (click)="open(confirmPro)">Vuoi
                      registrarti come professionista?</button>
                  </div>
                </div>
                <div *ngIf="userDetails.permission==='professional' && userDetails.experiences.length===0" class="form-group">
                  <div class="col-md-12">
                    <button type="button" class="btn btn-block btn-outline-secondary" style="width: auto;" (click)="createExperiences(proSignupForm)">Aggiungi
                      esperienze</button>
                  </div>
                </div>
                <div class="form-group">
                  <div class="col-sm-12">
                    <button class="btn btn-success" type="submit">Aggiorna profilo</button>
                  </div>
                </div>
              </form>
            </div>
          </ng-template>
        </ngb-tab>
        <ngb-tab title="Media">
          <ng-template ngbTabContent>
            <div class="card-body">

              <button *ngIf="!userDetails.contact" class="btn btn-rounded btn-outline-dark" style="margin-top: 10px; margin-bottom: 10px;"
                (click)="uploadProfilePic(uploadMedia)"><i class="fas fa-image"></i> Carica nuovo immagine</button>

              <ng-template #uploadMedia let-c="close" let-d="dismiss" style="margin-top: 150px;">
                <div class="modal-header">
                  <h4 class="modal-title">Carica nuovo immagine</h4>
                  <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <div class="form-group">
                    <label for="filePost"></label>
                    <input type="file" id="filePost" accept="image/x-png,image/gif,image/jpeg" (change)="handleFileInputforMedia($event.target.files)">
                    <span *ngIf="imageSrc !== ''">
                      <img id="image" [src]="imageSrc || ''" style="width: 120px;" />
                    </span>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" id="closeUploadMedia" (click)="c('Close click')">Cancella</button>
                  <button type="button" class="btn btn-warning" (click)="uploadMediaImage()" [disabled]="!mediaToUpload"><span
                      class="fa fa-upload"></span> Upload</button>
                </div>
              </ng-template>
              <div class="row" *ngIf="imgArrays.length !== 0">
                <div class="col-lg-3 col-md-6 m-b-20" *ngFor="let imgArray of imgArrays; let i = index">
                  <img src="{{imgArray.src}}" class="img-fluid radius" style="height: 150px !important;width: 150px!important;" />
                </div>
              </div>
              <div class="" *ngIf="imgArrays.length === 0">
                <h4>Non ci sono immagini!</h4>
              </div>
            </div>
          </ng-template>
        </ngb-tab>
        <ngb-tab>
          <ng-template ngbTabTitle>
            <div (click)="users('active')">Utenti</div>
          </ng-template>
          <ng-template ngbTabContent>
            <div class="card-body">
              <div class="row">
                <div class="col-lg-3 col-md-6" *ngFor="let contact of contacts">
                  <div class="card" style="background-color: #f5f5f5;">
                    <div class="card-body">
                      <div class="no-block align-items-center">
                        <div class="text-center">
                          <div *ngIf="!contact.profilePic">
                            <div *ngIf="contact.gender === 'Female'">
                              <img src="assets/images/users/female-avatar.png" class="rounded-circle" width="150"
                                height="150" [class.user]="contact.permission == 'user'" [class.ambassador]="contact.permission == 'ambassador'"
                                [class.professional]="contact.permission == 'professional'" />
                            </div>
                            <div *ngIf="contact.gender === 'Male'">
                              <img src="assets/images/users/male-avatar.png" class="rounded-circle" width="150" height="150"
                                [class.user]="contact.permission == 'user'" [class.ambassador]="contact.permission == 'ambassador'"
                                [class.professional]="contact.permission == 'professional'" />
                            </div>
                            <div *ngIf="contact.gender === 'Not Declared'">
                              <img src="assets/images/users/not-declared.png" class="rounded-circle" width="150" height="150"
                                [class.user]="contact.permission == 'user'" [class.ambassador]="contact.permission == 'ambassador'"
                                [class.professional]="contact.permission == 'professional'" />
                            </div>
                          </div>
                          <div *ngIf="contact.profilePic">
                            <img src="{{contact.profilePic}}" class="rounded-circle" width="150" height="150"
                              [class.user]="contact.permission == 'user'" [class.ambassador]="contact.permission == 'ambassador'"
                              [class.professional]="contact.permission == 'professional'" />
                          </div>
                          <h4 class="card-title m-t-10 pointer" (click)="viewProfile(contact._id)">{{contact.name}}
                            {{contact.surname}}</h4>
                          <div *ngIf="contact.permission==='professional'">
                            <h6 class="card-subtitle">{{contact.profession}}</h6>
                            <h6 *ngIf="!contact.profession" class="card-subtitle">Titolo not impostato</h6>
                          </div>
                          <div *ngIf="contact.permission!=='professional'">
                            <h6 class="card-subtitle">&nbsp;</h6>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
        </ngb-tab>
        <ngb-tab *ngIf="!userDetails.private || !userDetails.contact">
          <ng-template ngbTabTitle>
            <div (click)="getTimeline('active')">Timeline</div>
          </ng-template>
          <ng-template ngbTabContent>
            <div class="card-body">
              <div class="row">
                <div class="col-12">
                  <div class="card">
                    <div class="card-body">

                      <ngb-accordion #acc="ngbAccordion" class="accordion nav-accordion" [activeIds]="activeIds" *ngIf="!userDetails.contact">
                        <ngb-panel title="Aggiungi timeline" id="panel-0" style="color: red;">
                          <ng-template ngbPanelContent>
                            <form action="" class="form-horizontal form-material" (submit)="createTimelineItem();"
                              ngNativeValidate>

                              <div class="form-group">
                                <label class="col-md-12">Titolo</label>
                                <div class="col-md-12">
                                  <input type="text" placeholder="Titolo" class="form-control form-control-line" name="title"
                                    [(ngModel)]="timelineObject.title" required oninvalid="this.setCustomValidity('Titolo non può essere vuoto.')"
                                    onchange="this.setCustomValidity('')">
                                </div>
                              </div>

                              <div class="form-group">
                                <label class="col-md-12">Data</label>
                                <div class="col-md-12">
                                  <input type="date" id="timelineObject.time" class="form-control form-control-line"
                                    name="timelineObject.time" [(ngModel)]="timelineObject.time" required oninvalid="this.setCustomValidity('Data non può essere vuoto.')"
                                    onchange="this.setCustomValidity('')">
                                </div>
                              </div>

                              <div class="form-group">
                                <label class="col-md-12">Testo</label>
                                <div class="col-md-12">
                                  <textarea type="text" rows="5" placeholder="Testo" class="form-control form-control-line"
                                    name="contetn" [(ngModel)]="timelineObject.content" required oninvalid="this.setCustomValidity('Text non può essere vuoto.')"
                                    onchange="this.setCustomValidity('')"></textarea>
                                </div>
                              </div>

                              <div class="form-group">
                                <label for="fileTimeline"></label>
                                <input type="file" id="fileTimeline" (change)="handleFileInputforTimeline($event.target.files)">
                                <span *ngIf="imageSrcTimeline !== ''">
                                  <img id="image" [src]="imageSrcTimeline || ''" style="width: 120px;" />
                                </span>
                              </div>

                              <button type="submit" class="btn btn-outline-warning m-t-20">Crea</button>
                              <button type="button" class="btn btn-outline-dark m-t-20" (click)="collapse()">Cancella</button>
                            </form>
                          </ng-template>
                        </ngb-panel>
                      </ngb-accordion>
                      <div>

                        <ul class="timeline" *ngFor="let timeline of timelineData; let i = index">

                          <ng-template #DeleteTimeline let-c="close" let-d="dismiss" style="margin-top: 150px;">
                            <div class="modal-header">
                              <h4 class="modal-title">Elimina Timeline item? </h4>
                              <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                              <p>Sei sicuro di voler eliminare questo timeline item ?</p>
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" id="closeTimeline" (click)="c('Close click')">Cancella</button>
                              <button type="button" class="btn btn-danger" (click)="deleteTimeline(timeline._id)">Elimina</button>
                            </div>
                          </ng-template>

                          <li class="timeline-item" [class.timeline-inverted]="i%2!==0">

                            <div class="timeline-badge success">
                              <img alt="user" src="assets/images/users/1.jpg" alt="img" class="img-fluid"> </div>
                            <div class="timeline-panel">
                              <span *ngIf="!userDetails.contact && editTimelineId!==timeline._id" style="float: right;margin-left: 10px;"
                                class="fa fa-times" (click)="confirmDeleteTimeline(DeleteTimeline)"></span>
                              <span *ngIf="!userDetails.contact && editTimelineId!==timeline._id" style="float: right;"
                                class="fa fa-edit" (click)="changeTimelineStatus(timeline._id)"></span>
                              <div *ngIf="editTimelineId!==timeline._id">
                                <div class="timeline-heading">
                                  <h4 class="timeline-title">{{timeline.title}}</h4>
                                  <p>
                                    <small class="text-muted capitalize">
                                      <i class="fa fa-clock-o"></i>{{timeline.time}}</small>
                                  </p>
                                </div>
                                <div class="timeline-body">
                                  <p>{{timeline.content}}</p>
                                </div>
                                <div class="row" *ngIf="timeline.image">
                                  <div class="col-lg-3 col-md-6 m-b-20">
                                    <img src="{{timeline.image}}" style="width: 200px; height: 200px;" />
                                  </div>
                                </div>
                              </div>
                              <div>
                                <div *ngIf="timelineEditable && editTimelineId===timeline._id">
                                  <form action="" class="form-horizontal row" (submit)="editTimeline(timeline._id, timeline.title, timeline.content);"
                                    ngNativeValidate>
                                    <input type="text" placeholder="Titolo" class="form-control form-control-line" name="title"
                                      [(ngModel)]="timeline.title" required oninvalid="this.setCustomValidity('Titolo non può essere vuoto.')"
                                      onchange="this.setCustomValidity('')">
                                    <textarea class="form-control form-control-line m-t-20" placeholder="Text ..." rows="5"
                                      name="text" [(ngModel)]="timeline.content" required oninvalid="this.setCustomValidity('Text non può essere vuoto.')"
                                      onchange="this.setCustomValidity('')"></textarea>
                                    <button type="button" class="btn btn-outline-dark m-t-20" (click)="changeTimelineStatus('')">Cancella</button>
                                    <button type="submit" class="btn btn-outline-warning m-t-20">Aggiorna</button>
                                  </form>
                                </div>

                              </div>
                            </div>
                          </li>
                          <!-- <li class="timeline-inverted timeline-item">
                          <div class="timeline-badge warning">
                            <img class="img-fluid" alt="user" src="assets/images/users/2.jpg" alt="img"> </div>
                          <div class="timeline-panel">
                            <div class="timeline-heading">
                              <h4 class="timeline-title">Ritesh Deshmukh</h4>
                            </div>
                            <div class="timeline-body">
                              <p>
                                <img class="img-fluid" alt="user" src="assets/images/users/3.jpg" alt="img">
                              </p>
                              <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laudantium maiores odit qui est
                                tempora eos, nostrum provident explicabo dignissimos debitis vel! Adipisci eius voluptates,
                                ad aut recusandae minus eaque facere.</p>
                            </div>
                          </div>
                        </li>
                        <li class="timeline-item">
                          <div class="timeline-badge danger">
                            <span class="font-12">2018</span>
                          </div>
                          <div class="timeline-panel">
                            <div class="timeline-heading">
                              <h4 class="timeline-title">Lorem ipsum dolor</h4>
                            </div>
                            <div class="timeline-body">
                              <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Repellendus numquam facilis enim
                                eaque, tenetur nam id qui vel velit similique nihil iure molestias aliquam, voluptatem totam
                                quaerat, magni commodi quisquam.</p>
                            </div>
                          </div>
                        </li>
                        <li class="timeline-inverted timeline-item">
                          <div class="timeline-panel">
                            <div class="timeline-heading">
                              <h4 class="timeline-title">Lorem ipsum dolor</h4>
                            </div>
                            <div class="timeline-body">
                              <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptates est quaerat asperiores
                                sapiente, eligendi, nihil. Itaque quos, alias sapiente rerum quas odit! Aperiam officiis
                                quidem delectus libero, omnis ut debitis!</p>
                            </div>
                          </div>
                        </li>
                        <li class="timeline-item">
                          <div class="timeline-badge info">
                            <i class="fa fa-save"></i>
                          </div>
                          <div class="timeline-panel">
                            <div class="timeline-heading">
                              <h4 class="timeline-title">Lorem ipsum dolor</h4>
                            </div>
                            <div class="timeline-body">
                              <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nobis minus modi quam ipsum alias
                                at est molestiae excepturi delectus nesciunt, quibusdam debitis amet, beatae consequuntur
                                impedit nulla qui! Laborum, atque.</p>
                              <hr>
                              <div class="btn-group">
                                <button type="button" class="btn btn-primary btn-sm dropdown-toggle" data-toggle="dropdown">
                                  <i class="fa fa-cog"></i>
                                  <span class="caret"></span>
                                </button>
                                <div class="dropdown-menu">
                                  <a class="dropdown-item" href="javascript:void(0)">Action</a>
                                  <a class="dropdown-item" href="javascript:void(0)">Another action</a>
                                  <a class="dropdown-item" href="javascript:void(0)">Something else here</a>
                                  <div class="dropdown-divider"></div>
                                  <a class="dropdown-item" href="javascript:void(0)">Separated link</a>
                                </div>
                              </div>
                            </div>
                          </div>
                        </li>
                        <li class="timeline-inverted timeline-item">
                          <div class="timeline-badge success">
                            <i class="fa fa-graduation-cap"></i>
                          </div>
                          <div class="timeline-panel">
                            <div class="timeline-heading">
                              <h4 class="timeline-title">Lorem ipsum dolor</h4>
                            </div>
                            <div class="timeline-body">
                              <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Deserunt obcaecati, quaerat tempore
                                officia voluptas debitis consectetur culpa amet, accusamus dolorum fugiat, animi dicta aperiam,
                                enim incidunt quisquam maxime neque eaque.</p>
                            </div>
                          </div>
                        </li> -->
                        </ul>
                        <div *ngIf="timelineData.length === 0">
                          <h4>Non ci sono timeline items</h4>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
        </ngb-tab>
      </ngb-tabset>
    </div>
  </div>
  <!-- Column -->
</div>